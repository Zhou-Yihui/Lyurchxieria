<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>星门国家邮件系统 | SCMS</title>
<style>
body{font-family:"Microsoft YaHei",sans-serif;background:#0b0c2a;color:#fff;text-align:center;margin:0;}
header{padding:25px;background:rgba(255,255,255,.05);}
section{width:90%;max-width:400px;margin:30px auto;background:rgba(255,255,255,.08);padding:20px;border-radius:10px;}
input,button{width:80%;padding:10px;margin:8px 0;border:none;border-radius:5px;}
button{background:#f0c000;color:#000;cursor:pointer;font-size:16px;}
button:hover{background:#ffd700;}
#auth-msg{color:#ff9;margin-top:10px;height:20px;}
</style>
</head>
<body>

<header>
  <h1>星门国家邮件系统</h1>
  <h3>StarGate Civilization Mail System</h3>
</header>

<section id="auth-section">
  <input id="username" placeholder="用户名 / Username" autocomplete="off"><br>
  <input id="password" type="password" placeholder="密码 / Password" autocomplete="off"><br>
  <button onclick="login()">登录 / Login</button>
  <button onclick="register()">注册 / Register</button>
  <p id="auth-msg"></p>
</section>

<script>
/* --------- 工具 --------- */
const getUsers = () => JSON.parse(localStorage.getItem('SCMS-users') || '{}');
const setUsers = u => localStorage.setItem('SCMS-users', JSON.stringify(u));
const msg = txt => document.getElementById('auth-msg').textContent = txt;

async function register(){
  const u = document.getElementById('username').value.trim();
  const p = document.getElementById('password').value.trim();
  if(!u||!p) return msg('用户名密码必填');
  const res = await fetch('http://localhost:3000/api/register',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({username:u, password:p})
  });
  const j = await res.json();
  j.ok ? msg('注册成功，请登录') : msg(j.msg);
}

async function login(){
  const u = document.getElementById('username').value.trim();
  const p = document.getElementById('password').value.trim();
  const res = await fetch('http://localhost:3000/api/login',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({username:u, password:p})
  });
  const j = await res.json();
  if(j.ok){
    localStorage.setItem('SCMS-currentUser', u);
    location.href = 'home.html';
  }else{
    msg(j.msg);
  }
}
</script>
</body>
</html>
